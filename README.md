# KEOPS (Keen Evaluator Of Parallel Sentences)

KEOPS (Keen Evaluation Of Parallel Sentences) provides a complete tool for manual evaluation of parallel sentences.

<img src="screenshots/guide/home.png" width="700" />

It can be installed, or run inside a Docker. See [INSTALLATION.md](INSTALLATION.md) for more information.


## Table of Contents ##
 * [Overview](#overview)  
   * [Admins](#admins)  
   * [Evaluators](#evaluators)
 * [DB Schema](#DB)
 * [FAQ: Frequently Asked Questions](#faq)
   * [Which format must corpora have to be properly uploaded to Keops?](#faq-corpora)
   * [Which languages are preloaded in Keops?](#faq-langs)
   * [What are "validation guidelines"?](#guidelines)
   * [Which format does the "task summary" file have?](#summary-format)
   * [Which format does the "annotated sentences" file have?](#annotation-format)


<a name="overview"></a>

## Overview ##

There are two main types of users in Keops: **Users** (also known as "Evaluators") and **Admins**.
Admins can perform management tasks (such as creating tasks, uploading corpora to evaluate, invite users...) and evaluation tasks,
while regular Users can only perform evaluation tasks (assigned by the Admins).

<a name="admins"></a>

### Admins ###
The most common **workflow** for an **Admin** is as follows: 

First, the Admin **invites** the evaluators to Keops, if they are not Keops users yet. For this, the Admin just needs their emails, and give them the **invitation token** generated by Keops.
The invitation token, together with the user email, is what an user needs to create its account.

Then the admin **uploads** one (or more) parallel **corpus**, indicating the source and target languages (most common EU languages are pre-loaded, but Admins can add new ones beforehand, if needed).

<img src="screenshots/corpora-page.png" width="700">

After these two first steps, the Admin creates a new **Project**, indicating its source and target languages.

<img src="screenshots/management-page.png" width="700" />


When the project is created, the Admin can create **Tasks** in the Project. 
For this, the Admin just needs to indicate who is the **evaluator** and the **corpus** to be evaluated. 
Please note that only users and corpora matching the project languages will be available for choosing.

<img src="screenshots/tasks-project-page.png" width="700">


Once the task is created, Evaluators can immediately start working on them.
When an Evaluator finishes evaluating all sentences from a task, and markes it as **DONE**, the Admin is able to **download** the stats of the evaluation (a CSV file containing the amount of sentences per evaluation label) and the annotated corpus (a TSV file containing the parallel sentences and their evaluations).

<img src="screenshots/guide/recap-val.png" width="700">

<a name="evaluators"></a>

### Evaluators ###

The common **workflow** for an **Evaluator** is simpler:

After getting an **invitation** (an invitation token, together with the evaluator's email), the Evaluator **signs up** and creates an account.
It's important that Evaluators include their languages, so Admins can assign tasks to them. 

<img src="screenshots/signup-page.png" width="700">


If the Evaluator already had an account in Keops, instead of signing up, the Evaluator just needs to **sign in**.

<img src="screenshots/guide/login.png" width="700">

Once logged in, in their Keops **homepage**, Evaluators can see a list of **tasks** they are assigned to.  
Evaluators just need to click the **start/continue** button of the desired task, and then start evaluating.

<img src="screenshots/tasks-page.png" width="700">

In the **evaluation** page,  two sentences are displayed (source above and target below).
The evaluator has to **annotate** the parallel sentence, this is, choose the **label** that fits the most (Wrong language, MT translation...) in case of error, or mark it as valid is the parallel sentence is correct.
**Validation guidelines** are also available at any time to help the Evaluator to choose the right option. 
Evaluators are also allowed to add a **comment** to each parallel sentence, in order to clarify their annotations.

<img src="screenshots/evaluation-page.png" width="700">


Once all sentences of a task are evaluated, the Evaluator is redirected to the **recap** page for the task, where the evaluation stats of the task are shown. 
By marking the task as **DONE**, the Evaluator states that the task is finished, and from that moment, the Admin is able to **download** the stats of the evaluation and the evaluated sentences.

<img src="screenshots/guide/recap-val.png" width="700">


<a name="DB"></a>

## DB Schema ##

![DB Schema](keops.png)

A project can have several tasks (see table "tasks"), each one consisting of several sentences (see table "sentences_tasks"). 

Sentences belong to a corpus (see table "corpora" and "sentences"), but can be used in several  tasks (see table "sentences_tasks")

A task can only have one user assigned to it (see table "tasks"), but one user can have several tasks assignated.

An user (admin or evaluator) can have to several languages associated (see table "user_langs"). 

An admin can have several projects (see table "projects"), but each project has only one administrator (owner).

<a name="faq"></a>

## FAQ: Frequently Asked Questions ##

<a name="faq-corpora"></a>

### Which format must corpora have to be properly uploaded to Keops? ###

The corpus format that Keops does currently support is TSV files having one pair of sentences per line (and no header). For example:

```
Hello   Hola
Good morning    Buenos días
It's raining cats and dogs  Está lloviendo a cántaros
```

<a name="faq-langs"></a>

### Which languages are preloaded in Keops? ###
 
Preloaded languages are:  Bulgarian (bg), Czech (cs), Danish (da),  German (de), Greek (el), English (en), Spanish (es), Estonian (et), Finnish (fi), French (fr),  
Irish (ga), Croatian (hr), Hungarian (hu), Italian (it), Lithuanian (lt), Latvian (lv), Maltese (mt), Dutch (nl), Polish (pl),  Portuguese (pt), Romanian (ro), 
Slovak (sk), Slovenian (sl) and Swedish (sv)

But remember: Admins can add as many languages as needed, at any time!

<a name="guidelines"></a>

### What are "validation guidelines"? ###

Evaluators working with Keops must follow the European Language Resource Coordination (ELRC) validation guidelines.

To ensure consistency from one evaluator to another, the following system has been adopted for grading translations.
Evaluators should use the following types/labels to tag problematic cases:

 
  * Wrong language identification 
  * Incorrect alignment
  * Wrong tokenization
  * MT translation
  * Translation error
  * Free translation
 

For more information on each label, please check the [ELRC Validation Guidelines document](http://www.lr-coordination.eu/sites/default/files/common/ELRC%20Data%20Validation%20Guidelines.pdf), section "4.2.2.2  Validation by human experts".

Remember: Evaluators can refer to the Validation Guidelines at any time, just clicking in the link in the Evaluation window.

<a name="summary-format"></a>

### Which format does the "task summary" file have? ###

The Task Summary (or task stats) file is a CSV file containing the amount of parallel sentences per each label.  

Each line contains the Label code, the Label description and the amount of entries tagged with that label in the task. For example:

```
Label,Description,Count
L,Wrong language identification,44
A,Incorrect alignment,150
T,Wrong tokenization,204
MT,MT translation,97
E,Translation error,70
F,Free translation,39
V,Valid translation,396
P,Pending,0
Total,Total,1000
```

<a name="annotation-format"></a>

### Which format does the "annotated sentences" file have? ###

The Annotated Sentences file is a TSV file containing all parallel sentences that were evaluated in a task, as well as their evaluations (labels) and Evaluator comments (if any).

An example of an annotated sentences file follows:

```
Source	Target	Source lang	Target lang	Evaluation	Description	Comments
Use and maintenance manual	Manual de empleo y mantenimiento	en	es	V	Valid translation	
Tooling for cup chain aka tennis chain	Herramienta para cadena tennis	en	es	MT	MT translation	
Type of heating HVAC system	Tipo de calefacción Aire acondicionado frào-calor	en	es	L	Wrong language identification	This sentence has wrong encoding. 
Budva - photo gallery, Montenegro, Montenegro photos	Lalibela- viajes , Etiopía, fotos de Etiopía, viajar a Etiopía	en	es	A	Incorrect alignment	
```